## 바이트 코드와 머신 코드 그리고 JIT 컴파일러

`머신 코드`는 CPU가 직접 실행할 수 있는 `이진 코드`이고, `바이트 코드`는 컴파일러에 의해서 생성된 중간 단계의 코드라고 할 수 있다. Java에서 `바이트 코드`는 `JVM`에서 실행되고 `JVM`의 `JIT 컴파일러`는 `바이트 코드`를 `머신 코드`로 변환하는 역할을 담당한다.



### 1. 머신 코드 (Machine Code)

- `머신 코드`는 **CPU에 의해서** 바로 수행될 수 있는 즉, 컴퓨터가 이해하고 실행할 수 있는 코드를 말한다.
- 우리는 사람에게 친숙한 `High-Level` 프로그래밍 언어(C언어, Java 등)로 작성한 코드를 `소스 코드`라고 하는데 이것은 <u>*컴퓨터가 실행할 수 없는 코드이다.*</u>
- 이러한 `High-Level`의 코드들은 `컴파일러`나 `인터프리터`에 의해서 `머신 코드`로 변환되고 CPU에 의해서 실행된다. 즉, `머신 코드`는 컴퓨터가 즉시 해석하고 실행할 수 있는 `이진 명령`의 집합이다.



### 2. 바이트 코드 (Byte Code)

- `소스 코드`가 컴파일된 후 생성되는 중간 단계의 코드를 `바이트 코드`라고 한다. 
- Java의 경우, `.java` 파일을 컴파일하면 `JVM`에서 실행될 수 있는 `바이트 코드`를 생성하는데 CPU에 의해서 실행되기 위해서는 `머신 코드`로 변환하는 단계를 다시 거쳐야 한다. 즉,  `바이트 코드`는 `JVM`과 같은 소프트웨어이 해석할 수 있도록 고안된 명령 집합이다.



### 3. 인터프리터 vs 컴파일러

- `인터프리터`와 `컴파일러` 모두 `High-Level` 프로그래밍 언어를 `머신 코드`로 변환한다는 공통점이 있다. 
- 차이점은 아래와 같다. `컴파일러`는 프로그램이 실행되기 전에 변환하고 `인터프리터`는 소스 코드를 한줄씩 번역하면서 실행한다. (즉, 프로그램의 실행과 소스 코드의 변환이 동시에 발생한다.)

#### 1) 인터프리터

- `인터프리터`는 프로그램이 실행되는 동안 `소스 코드`를 한줄씩 읽어가며 `머신 코드`로 변환한다.
- `소스 코드`를 한 줄씩 분석하며 `머신 코드`로 변환하기 때문에 전체를 변환하는 `컴파일러`에 비해 변환하는 시간이 적게 걸린다.

#### 2) 컴파일러

- 컴파일러는 프로그램이 실행되기 전에 `소스 코드` 전체를 `머신 코드`로 변환한다. 이 과정은 한 번만 수행된다.
- `소스 코드` 전체를 분석하여 `error`가 없는 경우 `머신 코드`로 변환하기 때문에 변환하는 시간이 오래 걸린다.
- 하지만 `소스 코드`에 `error`가 없어 `머신 코드`로 변환되고 나면 추가적인 변환 작업이 없기 때문에 실행 속도가 빠르다.

#### 컴파일러가 인터프리터보다 무조건 실행 속도가 빠르다고 할 수 있을까?

- 프로그램을 여러 번 수행하면 `인터프리터`의 경우 실행할 때 마다 `소스 코드`를 `머신 코드`로 변환해야 하는 작업이 발생하기 때문에 프로그램 실행 전 `머신 코드`로 변환하는 작업을 *한 번만* 수행하는 `컴파일러`와 비교했을 때 실행 속도는 뒤쳐질 수 밖에 없을 것이다.
- 하지만,  프로그램이 **딱 한번!!**만 실행된다고 가정한다면 `인터프리터`와 `컴파일러`의 실행 속도는 큰 차이가 없을 것 같다. (정확히는 어떤 환경에서 실행되느냐에 따라 결과가 달라질 것 같다.)



### 4. JIT 컴파일러

- `JIT 컴파일러`는 인터프리터와 컴파일의 이점 모두를 가지고 있다.
- `JIT 컴파일러`는 기본적으로 인터프리터 방식으로 `바이트 코드`를 `머신 코드`로 변환해가면서 실행한다.
- 하지만, 빈번하게 수행되는 코드는 실행될 때마다 불필요하게 `머신 코드`로 변환되지 않도록 한 번에 변환하고 이후에 호출될 때마다 미리 변환된 `오브젝트 코드`를 실행한다.

---

#### [출처]

[1. 바이트코드 vs 머신코드](https://www.konfinity.com/7-differences-between-byte-code-and-machine-code)

[2. JIT 컴파일러](https://www.freecodecamp.org/news/just-in-time-compilation-explained/)

[3. 인터프리터 vs 컴파일러](https://www.guru99.com/difference-compiler-vs-interpreter.html)

